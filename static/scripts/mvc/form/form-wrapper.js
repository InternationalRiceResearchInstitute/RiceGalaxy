define(["mvc/form/form-view","mvc/ui/ui-misc"],function(a,b){var c=Backbone.View.extend({initialize:function(a){this.model=new Backbone.Model(a),this.url=this.model.get("url"),this.redirect=this.model.get("redirect"),this.setElement("<div/>"),this.render()},render:function(){var c=this;$.ajax({url:Galaxy.root+this.url,type:"GET"}).done(function(d){var e=$.extend({},c.model.attributes,d),f=new a({title:e.title,message:e.message,status:e.status||"warning",icon:e.icon,inputs:e.inputs,buttons:{submit:new b.Button({tooltip:e.submit_tooltip,title:e.submit_title||"Save",icon:e.submit_icon||"fa-save",cls:"btn btn-primary ui-clear-float",onclick:function(){c._submit(f)}})}});c.$el.empty().append(f.$el)}).fail(function(){c.$el.empty().append(new b.Message({message:"Failed to load resource "+c.url+".",status:"danger",persistent:!0}).$el)})},_submit:function(a){var b=this;$.ajax({url:Galaxy.root+b.url,data:JSON.stringify(a.data.create()),type:"PUT",contentType:"application/json"}).done(function(c){var d={message:c.message,status:"success",persistent:!1};b.redirect?window.location=Galaxy.root+b.redirect+"?"+$.param(d):(a.data.matchModel(c,function(b,c){a.field_list[c].value(b.value)}),b._showMessage(a,d))}).fail(function(c){b._showMessage(a,{message:c.responseJSON.err_msg,status:"danger",persistent:!1})})},_showMessage:function(a,b){var c=a.$el.parents().filter(function(){return-1!=["auto","scroll"].indexOf($(this).css("overflow"))}).first();c.animate({scrollTop:0},500),a.message.update(b)}});return{View:c}});
//# sourceMappingURL=../../../maps/mvc/form/form-wrapper.js.map