define(["mvc/history/history-contents","mvc/dataset/states","utils/ajax-queue","mvc/base-mvc","utils/localization"],function(a,b,c,d){var e="jobs",f=d.SearchableModelMixin,g=Backbone.Model.extend(d.LoggableMixin).extend(d.mixin(f,{_logNamespace:e,defaults:{model_class:"Job",tool_id:null,exit_code:null,inputs:{},outputs:{},params:{},create_time:null,update_time:null,state:b.NEW},parse:function(a){return a.params=this.parseParams(a.params),a},parseParams:function(a){var b={};return _.each(a,function(a,c){b[c]=JSON.parse(a)}),b},initialize:function(b,c){this.debug(this+"(Job).initialize",b,c),this.set("params",this.parseParams(this.get("params")),{silent:!0}),this.outputCollection=b.outputCollection||new a.HistoryContents([]),this._setUpListeners()},_setUpListeners:function(){this.on("change:state",function(a,b){this.log(this+" has changed state:",a,b),this.inReadyState()&&this.trigger("state:ready",a,b,this.previous("state"))})},inReadyState:function(){return _.contains(b.READY_STATES,this.get("state"))},hasDetails:function(){return!_.isEmpty(this.get("outputs"))},urlRoot:Galaxy.root+"api/jobs",toString:function(){return["Job(",this.get("id"),":",this.get("tool_id"),")"].join("")}})),h=Backbone.Collection.extend(d.LoggableMixin).extend({_logNamespace:e,model:g,urlRoot:Galaxy.root+"api/jobs",url:function(){return this.urlRoot},intialize:function(a,b){console.debug(a,b)},ids:function(){return this.map(function(a){return a.get("id")})},notReady:function(){return this.filter(function(a){return!a.inReadyState()})},haveDetails:function(){return this.all(function(a){return a.hasDetails()})},queueDetailFetching:function(){var a=this,b=new c.AjaxQueue(this.map(function(a){return function(){return a.fetch({silent:!0})}}));return b.done(function(){a.trigger("details-loaded")}),b},matches:function(a){return this.filter(function(b){return b.matches(a)})},toString:function(){return["JobCollection(",this.length,")"].join("")}},{fromHistory:function(a){console.debug(this);var b=this,c=new b([]);return c.fetch({data:{history_id:a}}).done(function(){window.queue=c.queueDetailFetching()}),c}});return{Job:g,JobCollection:h}});
//# sourceMappingURL=../../../maps/mvc/job/job-model.js.map