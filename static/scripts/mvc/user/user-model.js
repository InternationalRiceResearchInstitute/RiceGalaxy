define(["libs/underscore","libs/backbone","mvc/base-mvc","utils/localization"],function(a,b,c,d){"use strict";var e="user",f=b.Model.extend(c.LoggableMixin).extend({_logNamespace:e,urlRoot:function(){return Galaxy.root+"api/users"},defaults:{id:null,username:"("+d("anonymous user")+")",email:"",total_disk_usage:0,nice_total_disk_usage:"",quota_percent:null,is_admin:!1},initialize:function(a){this.log("User.initialize:",a),this.on("loaded",function(a,b){this.log(this+" has loaded:",a,b)}),this.on("change",function(a,b){this.log(this+" has changed:",a,b.changes)})},isAnonymous:function(){return!this.get("email")},isAdmin:function(){return this.get("is_admin")},loadFromApi:function(a,c){a=a||f.CURRENT_ID_STR,c=c||{};var d=this,e=c.success;return c.success=function(a,b){d.trigger("loaded",a,b),e&&e(a,b)},a===f.CURRENT_ID_STR&&(c.url=this.urlRoot+"/"+f.CURRENT_ID_STR),b.Model.prototype.fetch.call(this,c)},clearSessionStorage:function(){for(var a in sessionStorage)0===a.indexOf("history:")?sessionStorage.removeItem(a):"history-panel"===a&&sessionStorage.removeItem(a)},toString:function(){var a=[this.get("username")];return this.get("id")&&(a.unshift(this.get("id")),a.push(this.get("email"))),"User("+a.join(":")+")"}});f.CURRENT_ID_STR="current",f.getCurrentUserFromApi=function(a){var b=new f;return b.loadFromApi(f.CURRENT_ID_STR,a),b};b.Collection.extend(c.LoggableMixin).extend({model:f,urlRoot:function(){return Galaxy.root+"api/users"}});return{User:f}});
//# sourceMappingURL=../../../maps/mvc/user/user-model.js.map