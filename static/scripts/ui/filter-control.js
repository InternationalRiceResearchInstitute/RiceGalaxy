!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(b,c){function d(){var b=a(this),c=b.parents(".dropdown-select"),d=b.text();c.find(".dropdown-select-selected").text(d),c.trigger("change.dropdown-select",d)}c=c||(_.isEmpty(b)?"":b[0]);var e=a(['<div class="dropdown-select btn-group">','<button type="button" class="btn btn-default">','<span class="dropdown-select-selected">'+c+"</span>","</button>","</div>"].join("\n"));return b&&b.length>1&&(e.find("button").addClass("dropdown-toggle").attr("data-toggle","dropdown").append(' <span class="caret"></span>'),e.append(['<ul class="dropdown-menu" role="menu">',_.map(b,function(a){return['<li><a href="javascript:void(0)">',a,"</a></li>"].join("")}).join("\n"),"</ul>"].join("\n"))),e.find("a").click(d),e}function c(a,b){return this.init(a,b)}c.prototype.DATA_KEY="filter-control",c.prototype.init=function(b,c){return c=c||{filters:[]},this.$element=a(b).addClass("filter-control btn-group"),this.options=jQuery.extend(!0,{},this.defaults,c),this.currFilter=this.options.filters[0],this.render()},c.prototype.render=function(){return this.$element.empty().append([this._renderKeySelect(),this._renderOpSelect(),this._renderValueInput()]),this},c.prototype._renderKeySelect=function(){var a=this,c=this.options.filters.map(function(a){return a.key});return this.$keySelect=b(c,this.currFilter.key).addClass("filter-control-key").on("change.dropdown-select",function(b,c){a.currFilter=_.findWhere(a.options.filters,{key:c}),a.render()._triggerChange()}),this.$keySelect},c.prototype._renderOpSelect=function(){var a=this,c=this.currFilter.ops;return this.$opSelect=b(c,c[0]).addClass("filter-control-op").on("change.dropdown-select",function(){a._triggerChange()}),this.$opSelect},c.prototype._renderValueInput=function(){var c=this;return this.$valueSelect=this.currFilter.values?b(this.currFilter.values,this.currFilter.values[0]).on("change.dropdown-select",function(){c._triggerChange()}):a("<input/>").addClass("form-control").on("change",function(){c._triggerChange()}),this.$valueSelect.addClass("filter-control-value"),this.$valueSelect},c.prototype.val=function(){var a=this.$element.find(".filter-control-key .dropdown-select-selected").text(),b=this.$element.find(".filter-control-op .dropdown-select-selected").text(),c=this.$element.find(".filter-control-value"),d=c.hasClass("dropdown-select")?c.find(".dropdown-select-selected").text():c.val();return{key:a,op:b,value:d}},c.prototype._triggerChange=function(){this.$element.trigger("change.filter-control",this.val())},jQuery.fn.extend({filterControl:function(b){var d=jQuery.makeArray(arguments).slice(1);return this.map(function(){var e=a(this),f=e.data(c.prototype.DATA_KEY);if("object"===jQuery.type(b)&&(f=new c(e,b),e.data(c.prototype.DATA_KEY,f)),f&&"string"===jQuery.type(b)){var g=f[b];if("function"===jQuery.type(g))return g.apply(f,d)}return this})}})});
//# sourceMappingURL=../../maps/ui/filter-control.js.map