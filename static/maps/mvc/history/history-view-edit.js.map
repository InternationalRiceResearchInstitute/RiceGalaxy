{"version":3,"file":"history-view-edit.js","sources":["../../../src/mvc/history/history-view-edit.js"],"names":["define","HISTORY_VIEW","HISTORY_CONTENTS","STATES","HDA_MODEL","HDA_LI_EDIT","HDCA_LI_EDIT","TAGS","ANNOTATIONS","LIST_COLLECTION_CREATOR","PAIR_COLLECTION_CREATOR","LIST_OF_PAIRS_COLLECTION_CREATOR","faIconButton","PopupMenu","BASE_MVC","_l","_super","HistoryView","HistoryViewEdit","extend","HDAViewClass","HDAListItemEdit","HDCAViewClass","HDCAListItemEdit","initialize","attributes","prototype","call","this","tagsEditor","dragItems","annotationEditor","purgeAllowed","annotationEditorShown","tagsEditorShown","_setUpListeners","on","droptarget:drop","ev","data","dataDropped","dropTargetOff","view:attached view:removed","_renderCounts","search:loading-progress","_renderSearchProgress","search:searching","_renderSearchFindings","_setUpModelListeners","listenTo","model","updateHistoryDiskSize","_setUpCollectionListeners","collection","change:deleted","_handleItemDeletedChange","change:visible","_handleItemVisibleChange","change:purged","fetch","fetching-deleted","$","html","fetching-hidden","fetching-deleted-done fetching-hidden-done","_buildNewRender","$newRender","Galaxy","user","id","get","_renderTags","_renderAnnotation","text","renderItems","$whereTo","views","searchFor","jQuery","$el","templates","counts","toJSON","find","$where","panel","TagsEditor","el","onshowFirstTime","render","onshow","toggleHDATagEditors","fxSpeed","onhide","$activator","title","classes","faIcon","appendTo","AnnotationEditor","toggleHDAAnnotationEditors","_setUpBehaviors","isAnonymous","nameSelector","attr","tooltip","placement","make_text_editable","on_finish","newName","previousName","save","name","fail","previous","multiselectActions","actions","func","action","HistoryDatasetAssociation","hide","getSelectedModels","ajaxQueue","unhide","undelete","push","confirm","purge","concat","_collectionActions","buildCollection","collectionType","selection","hideSourceItems","createFunc","createListCollection","createPairCollection","createListOfPairsCollection","console","warn","done","refresh","_getItemViewOptions","options","_","hidden","itemModel","_handleItemDeletion","_handleItemUndeletion","contentsShown","deleted","active","contents","includeDeleted","removeItemView","set","_handleItemHidden","_handleItemUnhidden","includeHidden","showOrHide","speed","each","view","toggle","events","clone","click .show-selectors-btn","click .toggle-deleted-link","toggleShowDeleted","click .toggle-hidden-link","toggleShowHidden","limit","offset","stop","join","found","dropTargetOn","dropTarget","dropHandlers","dragenter","bind","dragover","dragleave","drop","$dropTarget","_renderDropTarget","$list","before","_renderDropTargetHelp","evName","hasOwnProperty","remove","addClass","_dropHandlers","off","dropTargetToggle","preventDefault","stopPropagation","css","self","dataTransfer","originalEvent","getData","dropEffect","JSON","parse","err","trigger","isObject","model_class","currentPage","fetchPage","then","copy","when","toString","countsTemplate","wrapTemplate","foundTemplate"],"mappings":"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"}