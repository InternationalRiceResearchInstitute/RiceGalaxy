<tool id="getVCFSubset" name="Get Subset of 3K VCF" version="1.0.2">
	<description> from Amazon S3 data repository </description>
	<command> 
	<![CDATA[
		#if str($selector.which_id) != "designation":
			sh $__tool_directory__/streamVCF.sh $selector.var '$output' '$chrom' '$start' '$end' '$reference'
		#else:
			sh $__tool_directory__/streamVCF.sh $selector.variety '$output' '$chrom' '$start' '$end' '$reference'
		#end if
	]]>
	</command>
	
	<inputs>
		<conditional name="selector">
			<param name="which_id" type="select" display="radiobutton" label="Search by:">
				<option value="designation"> Designation</option>
				<option value="assay_id"> Assay ID </option>
			</param> 
			<when value="designation">		
				<param name="variety" type="select" label="Variety Name/Designation">
					<options from_data_table="all_3k">
						<column name="name" index="2"/>
						<column name="value" index="1"/>
						<filter type="sort_by" column="2"/>
						<validator type="no_options" message="No genomes are available for the selected input dataset"/>
					</options>
				</param>
			</when>
			<when value="assay_id">		
				<param name="var" type="select" label="Variety ID/Assay ID">
					<options from_data_table="all_3k">
						<column name="name" index="1"/>
						<column name="value" index="1"/>
						<filter type="sort_by" column="1"/>
						<validator type="no_options" message="No genomes are available for the selected input dataset"/>
					</options>
				</param>
			</when>
		</conditional>
		<param name="reference" type="select" label="Reference Genome Used">
			<option value="Nipponbare"> Nipponbare 1.0 </option>
			<option value="IR64"> IR64 </option>
			<option value="9311"> 9311</option>
			<option value="DJ123"> DJ123 </option>
			<option value="Kasalath"> Kasalath </option>
		</param>
		<param name="chrom" type="text" size="10" label="Chromosome" />
		<param name="start" type="integer" size="4" value="1" min="1" label="Start Position" />
		<param name="end" type="integer" size="4" value="60000" label="End Position" />
	</inputs>

	<outputs>
		<data name="output" format="bcf_bgzip" label="Subset VCF"/>
	</outputs>

	<stdio>
		<exit_code range="2"   level="fatal"   description="Out of Memory" />
		<exit_code range="3:5" level="warning" description="Low disk space" />
		<exit_code range="6:"  level="fatal"   description="Bad input dataset" />
	</stdio>
	

	<help>
**Get VCF Subset:**
	
	Subset a VCF from a variety in the 3K Rice Genomes (3KRG) dataset.
	

	Input:
		Variety
		
		Reference Genome Used (where variety is aligned and SNPs are called against)
	
		Chromosome
	
		Start Position
	
		End Position
		
	Output:
		BCF file containing the variety at specified position (needs to be converted to VCF for further analysis, use {bcftools view VCF/BCF conversion, view, subset and filter VCF/BCF files}.

	</help>	

</tool>
